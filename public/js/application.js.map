{"version":3,"names":[],"mappings":"","sources":["application.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\n$.ajaxSetup({\n    headers: {\n        'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n    }\n});\n//删除一级菜单\n$('#category_list').delegate('.delete-category-btn', 'click', function () {\n    var that = $(this);\n\n    $.ajax({\n        type: 'delete',\n        url: '/admin/categories/' + that.parent().attr('data-category-id'),\n        dataType: 'json',\n        success: function success(data) {\n            that.parent().remove();\n        }\n    });\n});\n\n$('#category_list').delegate('.child-category-btn', 'click', function () {\n    var that = $(this);\n    if (that.prev().find('input').val() == '') {\n        that.prev().find('input').focus();\n        that.next().text('子菜单名称不能为空');\n    } else {\n        $.ajax({\n            type: 'post',\n            url: '/admin/child_categories',\n            data: { category_id: that.parent().parent().attr('data-category-id'), name: that.prev().find('input').val() },\n            dataType: 'json',\n            success: function success(data) {\n                that.parent().next().append('<li data-child-category-id=\"' + data.child_category.id + '\">\\n                    ' + data.child_category.name + ' \\n                    <span class=\"delete-child-category-btn\">\\n                        <i class=\"fa fa-times\" aria-hidden=\"true\"></i>\\n                    </span>\\n                  </li>');\n                that.prev().find('input').val('');\n            }\n        });\n    }\n});\n\n$('#category_list').delegate('.delete-child-category-btn', 'click', function () {\n    var that = $(this);\n    $.ajax({\n        type: 'delete',\n        url: '/admin/child_categories/' + that.parent().attr('data-child-category-id'),\n        dataType: 'json',\n        success: function success(data) {\n            that.parent().remove();\n        }\n    });\n});\n\n$(document).ready(function () {\n    $('#commentForm textarea').keydown(function (e) {\n        if ((e.ctrlKey || e.metaKey) && e.keyCode == 13) {\n            $(\"#commentBtn\").click();\n        }\n    });\n\n    $.ajaxSetup({\n        headers: {\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n        }\n    });\n    $('#addProfession').find('button').click(function () {\n\n        var currentNode = $(this);\n        if ($('#addProfession').find('input').val() == '') {\n            $('#addProfession').append('<span class=\"text-danger\">请添加专业名称</span>');\n        } else {\n            $.ajax({\n                type: 'post',\n                url: '/admin/professions',\n                data: { name: $('#addProfession').find('input').val() },\n                success: function success(data) {\n                    $('#profession-table tbody').append('\\n                    <tr>\\n                        <td>New</td>\\n                        <td>' + data.profession.name + '</td>\\n                        <td>\\n                            <button class=\"btn btn-danger\" data-profession-id=\"' + data.profession.id + '\">\\u5220\\u9664</button>\\n                        </td>\\n                    </tr>');\n                    $('#addProfession').find('input').val('');\n                }\n            });\n        }\n    });\n    //删除职业\n    $('#profession-table').delegate('button', 'click', function () {\n        var that = $(this);\n        $.ajax({\n            type: 'delete',\n            url: '/admin/professions/' + that.attr('data-profession-id'),\n            success: function success(data) {\n                that.parent().parent().remove();\n            }\n        });\n    });\n\n    $('.delete-article-btn').click(function () {\n        var current_article = $(this);\n        if (confirm('确认删除该文章吗？')) {\n            $.ajax({\n                type: 'delete',\n                url: '/admin/articles/' + $(this).parent().parent().data('article-id'),\n                success: function success(data) {\n                    if (data.status == '0') {\n                        current_article.parent().parent().fadeOut();\n                    }\n                }\n            });\n        }\n    });\n\n    $('.removeProfession').click(function () {\n        var currentNode = $(this);\n        var professionId = currentNode.parent().data('profession-id');\n        $.ajax({\n            type: 'delete',\n            url: '/professions/' + professionId,\n            success: function success(data) {\n                currentNode.parent().fadeOut();\n            }\n        });\n    });\n\n    $('#add-category').click(function () {\n        if ($(this).prev().find('input').val() == '') {\n            $(this).prev().find('input').focus();\n            $(this).next().text('主菜单名称不能为空！');\n        } else {\n            var current_cate = $(this);\n            $.ajax({\n                type: 'post',\n                url: '/admin/categories',\n                data: { parent_id: 0, name: $(this).prev().find('input').val() },\n                dataType: 'json',\n                success: function success(data) {\n                    $('#category_list').append('<hr>' + '<li data-category-id=\"' + data.id + '\">' + data.name + '<span class=\"delete-category-btn\"><i class=\"fa fa-times\" aria-hidden=\"true\"></i></span>' + '<fieldset class=\"form-inline\">' + '<div class=\"form-group\">' + '<div class=\"input-group\">' + '<input class=\"form-control\" placeholder=\"添加子菜单\" required=\"required\" name=\"category\" type=\"text\">' + '<div class=\"input-group-addon\">' + '<i class=\"fa fa-check-square-o\" aria-hidden=\"true\">' + '</i>' + '</div>' + '</div>' + '</div>' + '' + ' <button class=\"btn btn-info child-category-btn\">添加子菜单</button><span class=\"text-danger\"></span>' + '</fieldset>' + '<ul></ul>' + '</li>');\n                    current_cate.prev().find('input').val('');\n                }\n            });\n        }\n        ;\n    });\n\n    $('#commentBtn').click(function () {\n        $.ajax({\n            type: 'post',\n            url: '/comments',\n            dataType: 'json',\n            data: { article_id: $('#article').data('article-id'), content: $('#markdown').val(), parent_id: 0 },\n            success: function success(data) {\n                $('#commentList').append('<div class=\"meida\">' + '<a href=\"\" class=\"media-left\">' + '<img src=\"' + $('#imgUrl').attr('src') + '\" alt=\"\" width=\"80\" height=\"80\">' + '</a>' + '<div class=\"media-body\" data-comment-id=\"' + data.commentId + '\">' + '<h6 class=\"media-heading\">' + $('#userName').text() + '<small>' + data.createdAt + ' #' + data.floor + '</small>' + '</h6>' + data.content + '<div class=\"text-xs-right\">' + '<button class=\"btn btn-outline-info reply\">' + '回复' + '</button>' + '</div>' + '</div>' + '</div>' + '<hr>');\n                $('#markdown').val('');\n            }\n        });\n    });\n    //启动模态框\n    $('.reply').click(function () {\n        var commentId = $(this).parent().parent().attr('data-comment-id');\n        $('#myModal').attr('data-parent-id', commentId);\n        $('#myModal').modal('show');\n    });\n    $('.replyBtn').click(function () {\n        var content = $(this).parent().prev().find('textarea').val();\n        $.ajax({\n            type: 'post',\n            url: '/comments',\n            dataType: 'json',\n            data: {\n                article_id: $('#article').data('article-id'),\n                content: content,\n                parent_id: $('#myModal').attr('data-parent-id')\n            },\n            success: function success(data) {\n                $('#commentList').append('<div class=\"meida\">\\n            <a href=\"\" class=\"media-left\">\\n                <img src=\"' + $('#imgUrl').attr('src') + '\" width=\"80\" height=\"80\">\\n            </a>\\n        <div class=\"media-body\" data-comment-id=\"' + data.commentId + '\">\\n            <h6 class=\"media-heading\">' + $('#userName').text() + ' <small>' + data.createAt + '</small></h6>\\n            ' + data.content + '\\n    \\n            <div class=\"text-xs-right\">\\n              <button class=\"btn btn-outline-info reply\">\\u56DE\\u590D</button>\\n            </div>\\n        </div>\\n    </div>');\n                $('#myModal').modal('hide').find('textarea').val('');\n            }\n        });\n    });\n\n    $('#support').click(function () {\n        $.ajax({\n            type: 'post',\n            url: '/articles/' + $('#article').data('article-id') + '/support',\n            dataType: 'json',\n            success: function success(data) {\n                $('#supportCount').text(data.supportCount);\n            }\n        });\n    });\n    $('#unsupport').click(function () {\n        $.ajax({\n            type: 'post',\n            url: '/articles/' + $('#article').data('article-id') + '/unsupport',\n            dataType: 'json',\n            success: function success(data) {\n                $('#unsupportCount').text(data.unsupportCount);\n            }\n        });\n    });\n\n    $('#likeable').click(function () {\n        if ($('#likeable').attr('data-likeable-id') == '0') {\n            $.ajax({\n                type: 'post',\n                url: '/likeables',\n                dataType: 'json',\n                data: { article_id: $('#article').data('article-id') },\n                success: function success(data) {\n                    $('#likeable').toggleClass('fa-heart-o fa-heart').attr('data-likeable-id', data.likeableId);\n                    $('#likeCount').text(data.likeCount);\n                }\n            });\n        } else {\n            $.ajax({\n                type: 'delete',\n                url: '/likeables/' + $('#likeable').attr('data-likeable-id'),\n                dataType: 'json',\n                data: {\n                    likeable_id: $('#likeable').attr('data-likeable-id'),\n                    article_id: $('#article').data('article-id'),\n                    _method: 'delete'\n                },\n                success: function success(data) {\n                    $('#likeable').toggleClass('fa-heart-o fa-heart').attr('data-likeable-id', 0);\n                    $('#likeCount').text(data.likeCount);\n                }\n            });\n        }\n    });\n\n    $('#collect').click(function () {\n        if ($('#collect').attr('data-collect-id') == '0') {\n            $.ajax({\n                type: 'post',\n                url: '/collects',\n                dataType: 'json',\n                data: { article_id: $('#article').data('article-id') },\n                success: function success(data) {\n                    $('#collect').removeClass('btn-default').addClass('btn-danger').attr('data-collect-id', data.data.id);\n                    $('#collect>span').text(' 已收藏');\n                }\n            });\n        } else {\n            $.ajax({\n                type: 'delete',\n                url: '/collects/' + $('#collect').attr('data-collect-id'),\n                dataType: 'json',\n                data: { article_id: $('#article').data('article-id'), _method: 'delete' },\n                success: function success(data) {\n                    $('#collect').addClass('btn-default').removeClass('btn-danger').attr('data-collect-id', 0);\n                    $('#collect>span').text(' 收藏');\n                }\n            });\n        }\n    });\n});\n\n\n\n},{}]},{},[1]);\n"],"file":"application.js"}